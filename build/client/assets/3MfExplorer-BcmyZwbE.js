import{r as Fr,j as R}from"./index-CKBIMJ8Q.js";var h=Uint8Array,b=Uint16Array,Cr=Int32Array,tr=new h([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),vr=new h([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ar=new h([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ur=function(r,e){for(var n=new b(31),a=0;a<31;++a)n[a]=e+=1<<r[a-1];for(var i=new Cr(n[30]),a=1;a<30;++a)for(var t=n[a];t<n[a+1];++t)i[t]=t-n[a]<<5|a;return{b:n,r:i}},sr=ur(tr,2),cr=sr.b,Sr=sr.r;cr[28]=258,Sr[258]=28;var kr=ur(vr,0),Ur=kr.b,Y=new b(32768);for(var l=0;l<32768;++l){var k=(l&43690)>>1|(l&21845)<<1;k=(k&52428)>>2|(k&13107)<<2,k=(k&61680)>>4|(k&3855)<<4,Y[l]=((k&65280)>>8|(k&255)<<8)>>1}var B=function(r,e,n){for(var a=r.length,i=0,t=new b(e);i<a;++i)r[i]&&++t[r[i]-1];var u=new b(e);for(i=1;i<e;++i)u[i]=u[i-1]+t[i-1]<<1;var v;if(n){v=new b(1<<e);var g=15-e;for(i=0;i<a;++i)if(r[i])for(var c=i<<4|r[i],s=e-r[i],f=u[r[i]-1]++<<s,o=f|(1<<s)-1;f<=o;++f)v[Y[f]>>g]=c}else for(v=new b(a),i=0;i<a;++i)r[i]&&(v[i]=Y[u[r[i]-1]++]>>15-r[i]);return v},N=new h(288);for(var l=0;l<144;++l)N[l]=8;for(var l=144;l<256;++l)N[l]=9;for(var l=256;l<280;++l)N[l]=7;for(var l=280;l<288;++l)N[l]=8;var gr=new h(32);for(var l=0;l<32;++l)gr[l]=5;var Er=B(N,9,1),Tr=B(gr,5,1),Q=function(r){for(var e=r[0],n=1;n<r.length;++n)r[n]>e&&(e=r[n]);return e},p=function(r,e,n){var a=e/8|0;return(r[a]|r[a+1]<<8)>>(e&7)&n},V=function(r,e){var n=e/8|0;return(r[n]|r[n+1]<<8|r[n+2]<<16)>>(e&7)},jr=function(r){return(r+7)/8|0},$=function(r,e,n){return(e==null||e<0)&&(e=0),(n==null||n>r.length)&&(n=r.length),new h(r.subarray(e,n))},br=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],w=function(r,e,n){var a=new Error(e||br[r]);if(a.code=r,Error.captureStackTrace&&Error.captureStackTrace(a,w),!n)throw a;return a},zr=function(r,e,n,a){var i=r.length,t=a?a.length:0;if(!i||e.f&&!e.l)return n||new h(0);var u=!n,v=u||e.i!=2,g=e.i;u&&(n=new h(i*3));var c=function(fr){var or=n.length;if(fr>or){var lr=new h(Math.max(or*2,fr));lr.set(n),n=lr}},s=e.f||0,f=e.p||0,o=e.b||0,y=e.l,E=e.d,U=e.m,F=e.n,D=i*8;do{if(!y){s=p(r,f,1);var P=p(r,f+1,3);if(f+=3,P)if(P==1)y=Er,E=Tr,U=9,F=5;else if(P==2){var I=p(r,f,31)+257,L=p(r,f+10,15)+4,_=I+p(r,f+5,31)+1;f+=14;for(var z=new h(_),G=new h(19),m=0;m<L;++m)G[Ar[m]]=p(r,f+m*3,7);f+=L*3;for(var d=Q(G),mr=(1<<d)-1,wr=B(G,d,1),m=0;m<_;){var rr=wr[p(r,f,mr)];f+=rr&15;var C=rr>>4;if(C<16)z[m++]=C;else{var T=0,O=0;for(C==16?(O=3+p(r,f,3),f+=2,T=z[m-1]):C==17?(O=3+p(r,f,7),f+=3):C==18&&(O=11+p(r,f,127),f+=7);O--;)z[m++]=T}}var er=z.subarray(0,I),S=z.subarray(I);U=Q(er),F=Q(S),y=B(er,U,1),E=B(S,F,1)}else w(1);else{var C=jr(f)+4,W=r[C-4]|r[C-3]<<8,q=C+W;if(q>i){g&&w(0);break}v&&c(o+W),n.set(r.subarray(C,q),o),e.b=o+=W,e.p=f=q*8,e.f=s;continue}if(f>D){g&&w(0);break}}v&&c(o+131072);for(var pr=(1<<U)-1,xr=(1<<F)-1,H=f;;H=f){var T=y[V(r,f)&pr],j=T>>4;if(f+=T&15,f>D){g&&w(0);break}if(T||w(2),j<256)n[o++]=j;else if(j==256){H=f,y=null;break}else{var nr=j-254;if(j>264){var m=j-257,M=tr[m];nr=p(r,f,(1<<M)-1)+cr[m],f+=M}var J=E[V(r,f)&xr],K=J>>4;J||w(3),f+=J&15;var S=Ur[K];if(K>3){var M=vr[K];S+=V(r,f)&(1<<M)-1,f+=M}if(f>D){g&&w(0);break}v&&c(o+131072);var ar=o+nr;if(o<S){var ir=t-S,yr=Math.min(S,ar);for(ir+o<0&&w(3);o<yr;++o)n[o]=a[ir+o]}for(;o<ar;++o)n[o]=n[o-S]}}e.l=y,e.p=H,e.b=o,e.f=s,y&&(s=1,e.m=U,e.d=E,e.n=F)}while(!s);return o!=n.length&&u?$(n,0,o):n.subarray(0,o)},Mr=new h(0),A=function(r,e){return r[e]|r[e+1]<<8},x=function(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16|r[e+3]<<24)>>>0},X=function(r,e){return x(r,e)+x(r,e+4)*4294967296};function Br(r,e){return zr(r,{i:2},e&&e.out,e&&e.dictionary)}var Z=typeof TextDecoder<"u"&&new TextDecoder,Nr=0;try{Z.decode(Mr,{stream:!0}),Nr=1}catch{}var Or=function(r){for(var e="",n=0;;){var a=r[n++],i=(a>127)+(a>223)+(a>239);if(n+i>r.length)return{s:e,r:$(r,n-1)};i?i==3?(a=((a&15)<<18|(r[n++]&63)<<12|(r[n++]&63)<<6|r[n++]&63)-65536,e+=String.fromCharCode(55296|a>>10,56320|a&1023)):i&1?e+=String.fromCharCode((a&31)<<6|r[n++]&63):e+=String.fromCharCode((a&15)<<12|(r[n++]&63)<<6|r[n++]&63):e+=String.fromCharCode(a)}};function hr(r,e){if(e){for(var n="",a=0;a<r.length;a+=16384)n+=String.fromCharCode.apply(null,r.subarray(a,a+16384));return n}else{if(Z)return Z.decode(r);var i=Or(r),t=i.s,n=i.r;return n.length&&w(8),t}}var Rr=function(r,e){return e+30+A(r,e+26)+A(r,e+28)},Dr=function(r,e,n){var a=A(r,e+28),i=hr(r.subarray(e+46,e+46+a),!(A(r,e+8)&2048)),t=e+46+a,u=x(r,e+20),v=n&&u==4294967295?Pr(r,t):[u,x(r,e+24),x(r,e+42)],g=v[0],c=v[1],s=v[2];return[A(r,e+10),g,c,i,t+A(r,e+30)+A(r,e+32),s]},Pr=function(r,e){for(;A(r,e)!=1;e+=4+A(r,e+2));return[X(r,e+12),X(r,e+4),X(r,e+20)]};function Wr(r,e){for(var n={},a=r.length-22;x(r,a)!=101010256;--a)(!a||r.length-a>65558)&&w(13);var i=A(r,a+8);if(!i)return{};var t=x(r,a+16),u=t==4294967295||i==65535;if(u){var v=x(r,a-12);u=x(r,v)==101075792,u&&(i=x(r,v+32),t=x(r,v+48))}for(var g=0;g<i;++g){var c=Dr(r,t,u),s=c[0],f=c[1],o=c[2],y=c[3],E=c[4],U=c[5],F=Rr(r,U);t=E,s?s==8?n[y]=Br(r.subarray(F,F+f),{out:new h(o)}):w(14,"unknown compression type "+s):n[y]=$(r,F,F+f)}return n}function Ir(){const[r,e]=Fr.useState(null),n=a=>{var u;const i=(u=a.target.files)==null?void 0:u[0];if(!i||!i.name.endsWith(".3mf"))return alert("Please upload a valid 3MF file.");const t=new FileReader;t.onload=()=>{var f;const v=Wr(new Uint8Array(t.result)),g=Object.keys(v).find(o=>o.endsWith("model_settings.config"));if(!g)return console.warn("No config found.");const c=new DOMParser().parseFromString(hr(v[g]),"application/xml"),s=(f=Array.from(c.querySelectorAll("plate metadata")).find(o=>o.getAttribute("key")==="thumbnail_file"))==null?void 0:f.getAttribute("value");if(s&&v[s]){const o=URL.createObjectURL(new Blob([v[s]],{type:"image/png"}));e(o)}else console.warn("Thumbnail not found.")},t.onerror=()=>alert("Error reading file."),t.readAsArrayBuffer(i)};return R.jsx("div",{className:"mt-[130px] p-4 max-w-7xl mx-auto flex flex-col gap-8 items-center justify-center border border-gray-700 rounded-lg",children:R.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[R.jsx("input",{className:"p-2 m-2 bg-gray-800 rounded-lg cursor-pointer hover:bg-gray-700 transition-colors",type:"file",accept:".3mf",onChange:n}),r&&R.jsx("img",{src:r,alt:"3MF Thumbnail",className:"mt-4 w-64 border rounded"})]})})}export{Ir as default};
