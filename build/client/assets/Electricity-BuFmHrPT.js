import{r as i,j as t}from"./index-CKBIMJ8Q.js";import{G as v}from"./GenericTable-BvYFbjE6.js";import{u as T}from"./components-DqBg-pzF.js";function S({filaments:o,printers:s,elecPrice:p,consoData:f}){const[n,y]=i.useState(null),[l,x]=i.useState(f),[c,b]=i.useState(s[0]),[d,j]=i.useState(o[0]),[u,g]=i.useState(p);async function w(){const e=JSON.stringify({newPrice:u}),a=await(await fetch("/api/electricity",{method:"PATCH",body:e})).json();console.log(a)}async function N(){const e=JSON.stringify(l),r=await fetch("/api/electricity",{method:"POST",body:e});console.log(await r.json())}return i.useEffect(()=>{let e=[];for(let r=0;r<l.length;r++){const a=s.find(m=>m.id==l[r].printerId);e.push({conso:l[r].consoKw,consoId:l[r].id,filamentType:l[r].filamentType,printerId:a.id,printerName:a.name,consoStr:l[r].consoKw+" kw/h"})}y(e)},[l]),t.jsx(t.Fragment,{children:t.jsxs("div",{className:` mt-[130px] p-4 w-full max-w-7xl mx-auto
			 flex flex-col  gap-8 items-center justify-center border border-gray-700 rounded-lg`,children:[t.jsxs("div",{className:"border border-gray-700 p-2 rounded-lg w-full flex flex-row gap-5 ",children:[t.jsxs("label",{className:"flex flex-col gap-0 items-start",children:[t.jsx("div",{className:"text-gray-400 text-sm italic",children:"Prix au kWh"}),t.jsx("input",{className:"p-2 bg-gray-900 rounded-lg w-32",type:"number",step:5e-4,min:0,placeholder:"0.1234",value:u,onChange:e=>g(Number(e.target.value))})]}),t.jsx("button",{className:"px-2 bg-gray-900 rounded-lg w-20 h-[42px] place-self-end border border-gray-700 hover:border-white",onClick:w,children:"Save"})]}),t.jsx("div",{className:"flex flex-grow w-full",children:n&&t.jsx(v,{data:n,headers:[{key:"printerName",label:"Printer"},{key:"filamentType",label:"Material"},{key:"consoStr",label:"Conso"}],removeElement:e=>x(l.filter(r=>r.id?r.id!=e.consoId:!(r.consoKw==e.conso&&r.printerId==e.printerId&&r.filamentType==e.filamentType))),showRemoveButton:!0})}),t.jsxs("div",{className:"flex flex-row gap-5 w-full justify-between",children:[t.jsxs("div",{className:"flex flex-row gap-5",children:[s&&t.jsxs("label",{className:"flex flex-col gap-0 items-start",children:[t.jsx("div",{className:"text-gray-400 text-sm italic",children:"Printer:"}),t.jsx("select",{className:"p-2 bg-gray-900 rounded-lg",value:c.id,onChange:e=>{b(s.filter(r=>r.id==Number(e.target.value))[0])},children:s.map((e,r)=>t.jsx("option",{value:e.id,children:e.name},r))})]}),o&&t.jsxs("label",{className:"flex flex-col gap-0 items-start",children:[t.jsx("div",{className:"text-gray-400 text-sm italic",children:"Filament:"}),t.jsx("select",{className:"p-2 bg-gray-900 rounded-lg",value:d,onChange:e=>{j(e.target.value)},children:o.map((e,r)=>t.jsx("option",{value:e,children:e},r))})]}),t.jsxs("label",{className:"flex flex-col gap-0 items-start",children:[t.jsx("div",{className:"text-gray-400 text-sm italic",children:"Conso (kWh)"}),t.jsx("input",{className:"p-2 bg-gray-900 rounded-lg w-32",type:"number",step:50,min:0,placeholder:"8==D",onChange:e=>g(Number(e.target.value))})]}),t.jsx("button",{className:`py-2 px-2 bg-gray-900 rounded-lg w-20  border border-gray-700 self-end
							hover:border-white`,onClick:()=>{if(!u||!c||!d){alert("Please fill in all fields before adding.");return}if(n==null?void 0:n.some(a=>a.filamentType===d&&a.printerId===c.id)){alert("A line with the same data already exists!");return}const r=[...l,{consoKw:u,filamentType:d,printerId:c.id}];x(r)},children:"add"})]}),t.jsx("button",{className:"px-2 bg-gray-900 rounded-lg w-20 h-[42px] place-self-end border border-gray-700 hover:border-white",onClick:()=>{if((()=>{for(const a of n||[]){const m=a.conso+a.filamentType+a.printerId;if(n.filter(h=>h.filamentType+"||"+h.printerId===m).length>1)return m}return!1})()){alert("duplicates found");return}N()},children:"Save"})]})]})})}const k=()=>[{title:"Electricity costs"},{name:"Electricity",content:"List of consumptions"}];function E(){const{materials:o,printers:s,electPrice:p,getDisplayElecData:f}=T();return t.jsx("div",{children:t.jsx(S,{filaments:o,printers:s,elecPrice:p,consoData:f})})}export{E as default,k as meta};
