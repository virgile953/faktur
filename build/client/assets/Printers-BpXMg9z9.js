import{r as c,U as R,j as a}from"./index-CKBIMJ8Q.js";import{G as V}from"./GenericTable-BvYFbjE6.js";import{F as je,a as Ne}from"./TrashIcon-BVHTyowk.js";import{F as ye,a as we,u as Te}from"./components-DqBg-pzF.js";import{n as G,f as re,s as Pe,K as _,a as H,y as B,o as F,_ as U,L as q,$ as ne,b as ie,u as L,T as K,c as Ie,d as P,P as A,F as I,t as Ce,e as ke,w as Se,g as Ee,O as te}from"./use-resolve-button-type-B2Wslbw_.js";function $e(){let e=c.useRef(!1);return G(()=>(e.current=!0,()=>{e.current=!1}),[]),e}function De({onFocus:e}){let[l,s]=c.useState(!0),t=$e();return l?R.createElement(re,{as:"button",type:"button",features:Pe.Focusable,onFocus:o=>{o.preventDefault();let r,n=50;function d(){if(n--<=0){r&&cancelAnimationFrame(r);return}if(e()){if(cancelAnimationFrame(r),!t.current)return;s(!1);return}r=requestAnimationFrame(d)}r=requestAnimationFrame(d)}}):null}const oe=c.createContext(null);function Fe(){return{groups:new Map,get(e,l){var s;let t=this.groups.get(e);t||(t=new Map,this.groups.set(e,t));let o=(s=t.get(l))!=null?s:0;t.set(l,o+1);let r=Array.from(t.keys()).indexOf(l);function n(){let d=t.get(l);d>1?t.set(l,d-1):t.delete(l)}return[r,n]}}}function Ae({children:e}){let l=c.useRef(Fe());return c.createElement(oe.Provider,{value:l},e)}function ce(e){let l=c.useContext(oe);if(!l)throw new Error("You must wrap your component in a <StableCollection>");let s=c.useId(),[t,o]=l.current.get(e,s);return c.useEffect(()=>o,[]),t}var Re=(e=>(e[e.Forwards=0]="Forwards",e[e.Backwards=1]="Backwards",e))(Re||{}),Me=(e=>(e[e.Less=-1]="Less",e[e.Equal=0]="Equal",e[e.Greater=1]="Greater",e))(Me||{}),Oe=(e=>(e[e.SetSelectedIndex=0]="SetSelectedIndex",e[e.RegisterTab=1]="RegisterTab",e[e.UnregisterTab=2]="UnregisterTab",e[e.RegisterPanel=3]="RegisterPanel",e[e.UnregisterPanel=4]="UnregisterPanel",e))(Oe||{});let Ue={0(e,l){var s;let t=U(e.tabs,m=>m.current),o=U(e.panels,m=>m.current),r=t.filter(m=>{var h;return!((h=m.current)!=null&&h.hasAttribute("disabled"))}),n={...e,tabs:t,panels:o};if(l.index<0||l.index>t.length-1){let m=L(Math.sign(l.index-e.selectedIndex),{[-1]:()=>1,0:()=>L(Math.sign(l.index),{[-1]:()=>0,0:()=>0,1:()=>1}),1:()=>0});if(r.length===0)return n;let h=L(m,{0:()=>t.indexOf(r[0]),1:()=>t.indexOf(r[r.length-1])});return{...n,selectedIndex:h===-1?e.selectedIndex:h}}let d=t.slice(0,l.index),j=[...t.slice(l.index),...d].find(m=>r.includes(m));if(!j)return n;let f=(s=t.indexOf(j))!=null?s:e.selectedIndex;return f===-1&&(f=e.selectedIndex),{...n,selectedIndex:f}},1(e,l){if(e.tabs.includes(l.tab))return e;let s=e.tabs[e.selectedIndex],t=U([...e.tabs,l.tab],r=>r.current),o=e.selectedIndex;return e.info.current.isControlled||(o=t.indexOf(s),o===-1&&(o=e.selectedIndex)),{...e,tabs:t,selectedIndex:o}},2(e,l){return{...e,tabs:e.tabs.filter(s=>s!==l.tab)}},3(e,l){return e.panels.includes(l.panel)?e:{...e,panels:U([...e.panels,l.panel],s=>s.current)}},4(e,l){return{...e,panels:e.panels.filter(s=>s!==l.panel)}}},X=c.createContext(null);X.displayName="TabsDataContext";function M(e){let l=c.useContext(X);if(l===null){let s=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,M),s}return l}let Z=c.createContext(null);Z.displayName="TabsActionsContext";function ee(e){let l=c.useContext(Z);if(l===null){let s=new Error(`<${e} /> is missing a parent <Tab.Group /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(s,ee),s}return l}function Le(e,l){return L(l.type,Ue,e,l)}let Ge="div";function _e(e,l){let{defaultIndex:s=0,vertical:t=!1,manual:o=!1,onChange:r,selectedIndex:n=null,...d}=e;const j=t?"vertical":"horizontal",f=o?"manual":"auto";let m=n!==null,h=H({isControlled:m}),u=B(l),[g,p]=c.useReducer(Le,{info:h,selectedIndex:n??s,tabs:[],panels:[]}),S=c.useMemo(()=>({selectedIndex:g.selectedIndex}),[g.selectedIndex]),E=H(r||(()=>{})),w=H(g.tabs),i=c.useMemo(()=>({orientation:j,activation:f,...g}),[j,f,g]),T=F(b=>(p({type:1,tab:b}),()=>p({type:2,tab:b}))),v=F(b=>(p({type:3,panel:b}),()=>p({type:4,panel:b}))),N=F(b=>{y.current!==b&&E.current(b),m||p({type:0,index:b})}),y=H(m?e.selectedIndex:g.selectedIndex),$=c.useMemo(()=>({registerTab:T,registerPanel:v,change:N}),[]);G(()=>{p({type:0,index:n??s})},[n]),G(()=>{if(y.current===void 0||g.tabs.length<=0)return;let b=U(g.tabs,k=>k.current);b.some((k,D)=>g.tabs[D]!==k)&&N(b.indexOf(g.tabs[y.current]))});let z={ref:u},O=q();return R.createElement(Ae,null,R.createElement(Z.Provider,{value:$},R.createElement(X.Provider,{value:i},i.tabs.length<=0&&R.createElement(De,{onFocus:()=>{var b,k;for(let D of w.current)if(((b=D.current)==null?void 0:b.tabIndex)===0)return(k=D.current)==null||k.focus(),!0;return!1}}),O({ourProps:z,theirProps:d,slot:S,defaultTag:Ge,name:"Tabs"}))))}let Be="div";function qe(e,l){let{orientation:s,selectedIndex:t}=M("Tab.List"),o=B(l),r=c.useMemo(()=>({selectedIndex:t}),[t]),n=e,d={ref:o,role:"tablist","aria-orientation":s};return q()({ourProps:d,theirProps:n,slot:r,defaultTag:Be,name:"Tabs.List"})}let We="button";function He(e,l){var s,t;let o=c.useId(),{id:r=`headlessui-tabs-tab-${o}`,disabled:n=!1,autoFocus:d=!1,...j}=e,{orientation:f,activation:m,selectedIndex:h,tabs:u,panels:g}=M("Tab"),p=ee("Tab"),S=M("Tab"),[E,w]=c.useState(null),i=c.useRef(null),T=B(i,l,w);G(()=>p.registerTab(i),[p,i]);let v=ce("tabs"),N=u.indexOf(i);N===-1&&(N=v);let y=N===h,$=F(x=>{var C;let W=x();if(W===K.Success&&m==="auto"){let he=(C=Ie(i))==null?void 0:C.activeElement,se=S.tabs.findIndex(ve=>ve.current===he);se!==-1&&p.change(se)}return W}),z=F(x=>{let C=u.map(W=>W.current).filter(Boolean);if(x.key===P.Space||x.key===P.Enter){x.preventDefault(),x.stopPropagation(),p.change(N);return}switch(x.key){case P.Home:case P.PageUp:return x.preventDefault(),x.stopPropagation(),$(()=>A(C,I.First));case P.End:case P.PageDown:return x.preventDefault(),x.stopPropagation(),$(()=>A(C,I.Last))}if($(()=>L(f,{vertical(){return x.key===P.ArrowUp?A(C,I.Previous|I.WrapAround):x.key===P.ArrowDown?A(C,I.Next|I.WrapAround):K.Error},horizontal(){return x.key===P.ArrowLeft?A(C,I.Previous|I.WrapAround):x.key===P.ArrowRight?A(C,I.Next|I.WrapAround):K.Error}}))===K.Success)return x.preventDefault()}),O=c.useRef(!1),b=F(()=>{var x;O.current||(O.current=!0,(x=i.current)==null||x.focus({preventScroll:!0}),p.change(N),Ce(()=>{O.current=!1}))}),k=F(x=>{x.preventDefault()}),{isFocusVisible:D,focusProps:xe}=ne({autoFocus:d}),{isHovered:ae,hoverProps:pe}=ke({isDisabled:n}),{pressed:le,pressProps:fe}=Se({disabled:n}),ge=c.useMemo(()=>({selected:y,hover:ae,active:le,focus:D,autofocus:d,disabled:n}),[y,ae,D,le,d,n]),be=ie({ref:T,onKeyDown:z,onMouseDown:k,onClick:b,id:r,role:"tab",type:Ee(e,E),"aria-controls":(t=(s=g[N])==null?void 0:s.current)==null?void 0:t.id,"aria-selected":y,tabIndex:y?0:-1,disabled:n||void 0,autoFocus:d},xe,pe,fe);return q()({ourProps:be,theirProps:j,slot:ge,defaultTag:We,name:"Tabs.Tab"})}let Ke="div";function Je(e,l){let{selectedIndex:s}=M("Tab.Panels"),t=B(l),o=c.useMemo(()=>({selectedIndex:s}),[s]),r=e,n={ref:t};return q()({ourProps:n,theirProps:r,slot:o,defaultTag:Ke,name:"Tabs.Panels"})}let Ve="div",ze=te.RenderStrategy|te.Static;function Ye(e,l){var s,t,o,r;let n=c.useId(),{id:d=`headlessui-tabs-panel-${n}`,tabIndex:j=0,...f}=e,{selectedIndex:m,tabs:h,panels:u}=M("Tab.Panel"),g=ee("Tab.Panel"),p=c.useRef(null),S=B(p,l);G(()=>g.registerPanel(p),[g,p]);let E=ce("panels"),w=u.indexOf(p);w===-1&&(w=E);let i=w===m,{isFocusVisible:T,focusProps:v}=ne(),N=c.useMemo(()=>({selected:i,focus:T}),[i,T]),y=ie({ref:S,id:d,role:"tabpanel","aria-labelledby":(t=(s=h[w])==null?void 0:s.current)==null?void 0:t.id,tabIndex:i?j:-1},v),$=q();return!i&&((o=f.unmount)==null||o)&&!((r=f.static)!=null&&r)?R.createElement(re,{"aria-hidden":"true",...y}):$({ourProps:y,theirProps:f,slot:N,defaultTag:Ve,features:ze,visible:i,name:"Tabs.Panel"})}let Qe=_(He),de=_(_e),ue=_(qe),me=_(Je),J=_(Ye),Y=Object.assign(Qe,{Group:de,List:ue,Panels:me,Panel:J});function Xe({selectedPrinter:e,setNewPrinter:l}){return a.jsxs("div",{className:"mx-auto max-w-7xl m-4 rounded-xl border border-gray-700 grid grid-cols-3",children:[a.jsxs("div",{className:"w-full p-2 col-span-2",children:[a.jsxs("div",{className:"flex flex-row justify-between mr-2 p-2 text-xl",children:[a.jsx("div",{children:e.name}),a.jsx("div",{children:e.price+" €"})]}),a.jsxs("div",{className:"p-2",children:[a.jsx("h1",{className:"text-base mb-2",children:"Options:"}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:a.jsx(V,{data:e.upgrades,headers:[{key:"installDate",label:"Date"},{key:"name",label:"Name"},{key:"price",label:"Price"}],showRemoveButton:!1})})]}),a.jsxs("div",{className:"p-2 overflow-hidden",children:[a.jsx("h1",{className:"text-base mb-2",children:"Consumables:"}),a.jsx("div",{className:"max-h-60 overflow-y-auto",children:a.jsx(V,{data:e.consumables,headers:[{key:"name",label:"Name"},{key:"lifeTime",label:"Expected Lifetime"},{key:"usedTime",label:"Used Time"},{key:"price",label:"Price"}],showRemoveButton:!1})})]})]}),a.jsxs("div",{className:"justify-self-end w-full h-full",children:[a.jsx("img",{src:e.image,alt:e.name,className:"h-full w-full rounded-r-xl object-cover"}),a.jsxs("div",{className:"col-span-2 relative -inset-y-12 -inset-x-4 flex justify-end gap-4 ",children:[a.jsxs("button",{className:"bg-gray-800 py-2 px-4 rounded-lg flex flex-row gap-2",onClick:()=>l(e),children:[a.jsx(je,{height:24}),"Edit"]}),a.jsxs("form",{method:"post",children:[a.jsx("input",{type:"hidden",name:"_action",value:"delete"}),a.jsx("input",{type:"hidden",name:"printerId",value:e.id}),a.jsxs("button",{type:"submit",className:"bg-red-800 py-2 px-4 rounded-lg flex flex-row gap-2",children:[a.jsx(Ne,{height:24}),"Delete"]})]})]})]})]})}function Ze({printers:e,selectedPrinter:l,onSelectPrinter:s}){return a.jsx("div",{className:"max-w-7xl mx-auto flex flex-row gap-0 overflow-x-auto relative",children:e.map((t,o)=>a.jsxs("div",{className:`flex-shrink-0 flex flex-row m-2 min-w-72 border border-gray-700
					rounded-xl relative cursor-pointer
					${l==t?"bg-gray-900":""}`,onClick:()=>s(t),children:[a.jsx("img",{src:t.image,className:"h-24 w-24 rounded-s-xl",alt:t.name}),a.jsxs("div",{className:"flex flex-col p-2 text-sm justify-between",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("div",{children:t.name}),a.jsx("div",{children:t.price+" €"})]}),a.jsx("div",{className:"relative group",children:a.jsx("div",{className:"text-xs",children:t.upgrades.length+" Options"})})]})]},o))})}function ea({setNewPrinter:e,newPrinter:l}){return a.jsxs(ye,{className:"grid grid-cols-3 grid-flow-row w-full gap-6",children:[a.jsxs("div",{className:"col-span-2",children:[a.jsxs("label",{className:"flex flex-col gap-1 mb-2",htmlFor:"printerName",children:["Name",a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1",id:"printerName",value:l.name||"",onChange:s=>e({...l,name:s.target.value})})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",htmlFor:"printerCost",children:["Price",a.jsxs("div",{className:"flex flex-row items-center",children:[a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full text-right",id:"printerCost",type:"number",value:l.price||"",onChange:s=>e({...l,price:Number(s.target.value)})}),a.jsx("span",{className:"ml-2",children:"€"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",htmlFor:"printerImage",children:["Image",a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1",id:"printerImage",value:l.image||"",onChange:s=>e({...l,image:s.target.value})})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",htmlFor:"printerConsumption",children:["Consumption (kw/h)",a.jsxs("div",{className:"flex flex-row items-center",children:[a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full text-right",id:"printerConsumption",type:"number",value:l.consumption||"",onChange:s=>e({...l,consumption:Number(s.target.value)})}),a.jsx("span",{className:"ml-2",children:"kW/h"})]})]})]}),a.jsx("div",{className:"justify-self-end w-full h-full",children:l.image?a.jsx("img",{src:l.image,alt:"Printer preview",className:"h-full w-full rounded-r-xl object-cover border border-gray-700"}):a.jsx("div",{className:"h-full w-full rounded-r-xl border border-gray-700 flex items-center justify-center text-gray-500",children:"Printer image preview"})})]})}function aa({newPrinter:e,setNewPrinter:l,newConsumable:s,setNewConsumable:t,newUpgrade:o,setNewUpgrade:r,newPrinterAddConsumable:n,newPrinterRemoveConsumable:d,newPrinterAddUpgrade:j,newPrinterRemoveUpgrade:f,createPrinter:m,updatePrinter:h}){return a.jsxs("div",{className:"max-w-7xl mx-auto justify-between m-4 min-h-max rounded-xl border border-gray-700 p-2",children:[a.jsxs("h1",{className:"mb-2",children:[e.id==null?"Ajouter":"Modifier"," une imprimante"]}),a.jsxs(de,{className:"ml-4 border border-gray-700 rounded-lg my-6 p-2 pb-6 ",children:[a.jsxs(ue,{className:"mb-4",children:[a.jsx(Y,{className:"py-2 px-4 data-[selected]:bg-gray-900 rounded-lg",children:"Base infos"}),a.jsx(Y,{className:"py-2 px-4 data-[selected]:bg-gray-900 rounded-lg",children:"Consumables"}),a.jsx(Y,{className:"py-2 px-4 data-[selected]:bg-gray-900 rounded-lg",children:"Options"})]}),a.jsxs(me,{className:"ml-4",children:[a.jsx(J,{className:"",children:a.jsx(ea,{setNewPrinter:l,newPrinter:e})}),a.jsx(J,{children:a.jsxs("div",{className:"flex flex-row gap-4",children:[e.consumables.length?a.jsx("div",{className:"w-full h-full overflow-y-auto max-h-80",children:a.jsx(V,{data:e.consumables,headers:[{key:"name",label:"Name"},{key:"lifeTime",label:"Expected lifetime"},{key:"usedTime",label:"Time of use"}],removeElement:d})}):a.jsxs("div",{className:"text-center text-3xl w-full",children:[a.jsx("br",{}),a.jsx("br",{}),"no consumables"]}),a.jsxs("div",{className:"w-56",children:[a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Name of consumable",a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full",value:s.name,onChange:u=>t({...s,name:u.target.value})})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Expected lifetime",a.jsxs("div",{className:"flex flex-row items-center",children:[a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 py-1 w-full text-right",type:"number",value:s.lifeTime,onChange:u=>t({...s,lifeTime:Number(u.target.value)})}),a.jsx("span",{className:"ml-2",children:"H"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Used time",a.jsxs("div",{className:"flex flex-row items-center",children:[a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full text-right",type:"number",value:s.usedTime,onChange:u=>t({...s,usedTime:Number(u.target.value)})}),a.jsx("span",{className:"ml-2",children:"H"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Price",a.jsxs("div",{className:"flex flex-row items-center",children:[a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full text-right",type:"number",value:s.price,onChange:u=>t({...s,price:Number(u.target.value)})}),a.jsx("span",{className:"ml-2",children:"€"})]})]}),a.jsx("button",{className:"py-2 px-4 bg-gray-900 rounded-lg border w-full mt-2",onClick:n,children:"Ajouter"})]})]})}),a.jsx(J,{children:a.jsxs("div",{className:"flex flex-row gap-4",children:[e.upgrades.length?a.jsx("div",{className:"w-full max-h-72 overflow-y-auto",children:a.jsx(V,{data:e.upgrades,headers:[{key:"name",label:"Name"},{key:"price",label:"Price"},{key:"installDate",label:"Date of install"}],removeElement:f})}):a.jsxs("div",{className:"text-center text-3xl w-full",children:[a.jsx("br",{}),a.jsx("br",{}),"no upgrades"]}),a.jsxs("div",{className:"w-56",children:[a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Name of upgrade",a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full",onChange:u=>r({...o,name:u.target.value})})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Price",a.jsxs("div",{className:"flex flex-row items-center",children:[a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full text-right",type:"number",onChange:u=>r({...o,price:Number(u.target.value)})}),a.jsx("span",{className:"ml-2",children:"€"})]})]}),a.jsxs("label",{className:"flex flex-col gap-1 mb-2",children:["Install date",a.jsx("div",{children:a.jsx("input",{className:"bg-gray-900 rounded-lg pl-2 p-1 w-full",type:"date",dir:"rtl",onChange:u=>r({...o,installDate:u.target.value})})})]}),a.jsx("button",{className:"py-2 px-4 bg-gray-900 rounded-lg border w-full mt-2",onClick:j,children:"Ajouter"})]})]})})]})]}),a.jsx("button",{className:"bg-gradient-to-t from-gray-900 to-gray-800 m-2 p-2 px-4 rounded-lg border",onClick:e.id==null?m:h,children:e.id==null?"Create ":"Update"})]})}const Q={image:"",name:"",price:0,consumption:0,upgrades:[],consumables:[],canPrint:[]},la={lifeTime:0,name:"",usedTime:0,price:0},sa={name:"",price:0,installDate:""};function ta({initialPrinters:e}){const[l,s]=c.useState(e),[t,o]=c.useState(e[0]),[r,n]=c.useState(Q),[d,j]=c.useState(la),[f,m]=c.useState(sa),h=we();function u(){const i=[...r.consumables];i.push(d),n({...r,consumables:i}),console.log(r.consumables)}function g(i){const T=[...r.consumables].filter(v=>!(v.name===i.name&&v.lifeTime===i.lifeTime&&v.price===i.price&&v.usedTime===i.usedTime));n({...r,consumables:T})}function p(){const i=[...r.upgrades];console.log(r.upgrades),i.push(f),n({...r,upgrades:i}),console.log(r.upgrades)}function S(i){const T=[...r.upgrades].filter(v=>!(v.name===i.name&&v.installDate===i.installDate&&v.price===i.price));n({...r,upgrades:T})}function E(){if(!r.name||!r.image||r.price<=0){console.log("Please fill in all required fields with valid values.");return}h({printerData:JSON.stringify(r),_action:"create"},{method:"post",encType:"multipart/form-data"}),s([...l,{...r,id:Date.now()}]),n(Q)}function w(){if(!r.name||!r.image||r.price<=0){console.log("Please fill in all required fields with valid values.");return}h({printerData:JSON.stringify(r),_action:"update"},{method:"put",encType:"multipart/form-data"}),n(Q),setTimeout(()=>window.location.reload(),10)}return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"mt-[130px] h-[calc(100vh-130px)]",children:[a.jsx(Ze,{printers:l,selectedPrinter:t,onSelectPrinter:i=>o(i)}),a.jsx(Xe,{selectedPrinter:t,setNewPrinter:n}),a.jsx(aa,{newPrinter:r,setNewPrinter:n,newConsumable:d,setNewConsumable:j,newUpgrade:f,setNewUpgrade:m,newPrinterAddConsumable:u,newPrinterRemoveConsumable:g,newPrinterAddUpgrade:p,newPrinterRemoveUpgrade:S,createPrinter:E,updatePrinter:w})]})})}const da=()=>[{title:"Printers"},{name:"Printers",content:"List of configured printers"}];function ua(){const{printers:e}=Te();return a.jsx(ta,{initialPrinters:e})}export{ua as default,da as meta};
